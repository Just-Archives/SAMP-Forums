<!DOCTYPE html><!-- start: printthread -->
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<title> [Include] Sasinosoft Map Loader - Printable Version</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="description" content="Sasinosoft Map Loader Download Download Source Description A file format, loader and converter to import maps (or scenery) into a San Andreas Multiplayer server, compatible with Pawn and C# (via SampS" />
<link rel="canonical" href="showthread6102.html?tid=676078" />
</head>
<body>
<div>

<div><a href="index-2.html"><img src="images/bootbb/logo_forum.gif" alt="SA-MP Forums Archive" title="SA-MP Forums Archive" /></a></div>


<div>
<span class="largetext"> <a href="showthread6102.html?tid=676078">[Include] Sasinosoft Map Loader</a> - Printable Version</span><br />
<br />
+- SA-MP Forums Archive (<em>https://sampforum.blast.hk</em>)<br />
<!-- start: printthread_nav -->
+-- Forum: SA-MP Scripting and Plugins (<i>https://sampforum.blast.hk/forumdisplay.php?fid=8</i>)<br />
<!-- end: printthread_nav --><!-- start: printthread_nav -->
+--- Forum: Filterscripts (<i>https://sampforum.blast.hk/forumdisplay.php?fid=17</i>)<br />
<!-- end: printthread_nav --><!-- start: printthread_nav -->
+---- Forum: Includes (<i>https://sampforum.blast.hk/forumdisplay.php?fid=83</i>)<br />
<!-- end: printthread_nav -->
+---- Thread:  [Include] Sasinosoft Map Loader (<em>/showthread.php?tid=676078</em>)<br />
<br />
</div>


<div><br /><hr size="1" /><!-- start: printthread_post -->
Sasinosoft Map Loader - <a href="memberadf8.html?action=profile&amp;uid=111937">Sasino97</a> -  29.05.2020
<br />
<br />
<font face="Impact"><div align="center"><font size="7"><font color="Red">S</font>asinosoft <font color="Red">M</font>ap <font color="red">L</font>oader</font></div></font><br />
<br />
<font face="Impact"><font size="6"><font color="Red">D</font>ownload</font></font><br />
<a href="https://github.com/SaSiNO97/MapLoader/releases" target="_blank">Download</a><br />
<a href="https://github.com/SaSiNO97/MapLoader" target="_blank">Source</a><br />
<br />
<font face="Impact"><font size="6"><font color="Red">D</font>escription</font></font><br />
A file format, loader and converter to import maps (or scenery) into a San Andreas Multiplayer server, compatible with <b><font color="Blue">Pawn</font></b> and <b><font color="DarkGreen">C#</font></b> (via SampSharp), and supporting Incognito's Streamer. It supports creating objects with custom materials and text, creating vehicles and attaching objects to them and removing buildings. It was designed to be as compact as possible, but readable by humans at the same time.<br />
<br />
<font face="Impact"><font size="6"><font color="Red">S</font>ML Format</font></font><br />
SML (Sasinosoft Map Language) format is a format used by the loader libraries and the converter. It is a CSV format that uses spaces as field separators.<br />
<br />
<font face="Impact"><font size="5"><font color="Red">E</font>xample</font></font><br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 498px;
		text-align: left;
		overflow: auto"># Constants
K DefaultInterior -1
K DefaultVW -1
K DefaultStreamDist 200.0
K DefaultDrawDist 200.0
K RemDist 10000.0

# Some building removals
R 955 0.0 0.0 0.0 RemDist
R 956 0.0 0.0 0.0 RemDist
R 1775 0.0 0.0 0.0 RemDist
R 1776 0.0 0.0 0.0 RemDist

# Some objects
C 1649 1110.95825 -811.06183 118.07580 0.00000 0.00000 323.50003 DefaultVW DefaultInterior DefaultStreamDist DefaultDrawDist
C 1649 1107.45630 -808.49719 118.07580 0.00000 0.00000 323.50003 DefaultVW DefaultInterior DefaultStreamDist DefaultDrawDist

# This object uses an array of integers as virtual worlds (only supported by the C# MapLoader)
C 1649 1105.95325 -807.36542 118.07580 0.00000 0.00000 323.50003 [500-520] DefaultInterior DefaultStreamDist DefaultDrawDist

# Some objects with custom materials
C 19379 1102.65100 -832.63092 116.35390 0.00000 90.00000 188.50000 DefaultVW DefaultInterior DefaultStreamDist DefaultDrawDist
M 0 13724 docg01_lahills ws_stationfloor 0
C 19379 1107.77612 -829.53491 116.39390 0.00000 90.00000 233.50000 DefaultVW DefaultInterior DefaultStreamDist DefaultDrawDist
M 0 13724 docg01_lahills ws_stationfloor 0
C 19379 1092.23718 -818.83722 119.63390 0.00000 90.00000 8.50000 DefaultVW DefaultInterior DefaultStreamDist DefaultDrawDist
M 0 10944 traintunnel2_sfse ws_tunnelwall2 0
C 19379 1093.64404 -828.31921 119.63390 0.00000 90.00000 8.50000 DefaultVW DefaultInterior DefaultStreamDist DefaultDrawDist
M 0 10944 traintunnel2_sfse ws_tunnelwall2 0

# An AT-400 jet with navigation lights and some text attached to it
V 577 0.0000 0.0000 0.0000 0.0000 1 1
A 19296 -30.19373 -5.69669 4.58001 0.000000 0.500000 180.000000 -1 -1 DefaultStreamDist DefaultDrawDist
A 19297 30.19373 -5.69669 4.58001 0.000000 0.500000 180.000000 -1 -1 DefaultStreamDist DefaultDrawDist
A 19290 0.00000 3.50000 7.00000 0.000000 0.500000 180.000000 -1 -1 DefaultStreamDist DefaultDrawDist
A 19482 2.3499 5.8199 6.0900 0.0000 -37.0000 0.0000 -1 -1 DefaultStreamDist DefaultDrawDist
T 0 {101010}Am 90 Arial 144 1 -1 0 1
A 19482 2.3499 9.6200 6.0900 0.0000 -37.0000 0.0000 -1 -1 DefaultStreamDist DefaultDrawDist
T 0 {101010}eri 90 Arial 144 1 -1 0 1
A 19482 2.3499 13.6500 6.0900 0.0000 -37.0000 0.0000 -1 -1 DefaultStreamDist DefaultDrawDist
T 0 {101010}can 90 Arial 144 1 -1 0 1</pre>
</div><font face="Impact"><font size="5"><font color="Red">D</font>irectives</font></font><br />
Directives are the first character found on each line. Empty lines are automatically discarded. All directives must be upper-case.<br />
<br />
<font size="4"><font color="Red">C</font>omments (#)</font><br />
Anything after the # symbol is ignored<br />
<br />
<font size="4"><font color="Red">C</font>onstants (K symbol value)</font><br />
The parser will replace the symbol with the value (works like #define in Pawn)<br />
<br />
<font size="4"><font color="Red">O</font>bjects (C or O model x y z rx ry rz [virtualWorld(s)] [interior(s)] [streamDistance] [drawDistance] [priority])</font><br />
Creates an object. If streamer.inc was included before it, it creates a dynamic object. In the C# version of the loader, it only works with Incognito's streamer plugin, and the streamer Nuget package is required.<br />
<br />
model The model id<br />
<br />
x y z The coordinates<br />
<br />
rx ry rz The rotation<br />
<br />
virtualWorld(s) The virtual world of the object. The Pawn loader only supports one virtual world, while the C# loader supports an array of virtual worlds using the array format (more on that later).<br />
<br />
interior(s) The interior of the object. The Pawn loader only supports one interior, while the C# loader supports an array of interiors using the array format.<br />
<br />
streamDistance The stream distance (no effect in the Pawn loader if streamer.inc is not included before)<br />
<br />
drawDistance The draw distance<br />
<br />
priority The stream priority (only supported by the C# loader)<br />
<br />
<font size="4"><font color="Red">V</font>ehicles (V model x y z r col1 col2)</font><br />
Creates a vehicle<br />
<br />
model The vehicle model type id<br />
<br />
x y z The coordinates<br />
<br />
r The rotation angle<br />
<br />
col1 col2 The colors<br />
<br />
<font size="4"><font color="Red">A</font>ttached Objects (A model offsetX offsetY offsetZ offsetRX offsetRY offsetRZ virtualWorld interior streamDistance drawDistance)</font><br />
Creates an object and attaches it to the last created vehicle (using the V directive). Will throw an error if no vehicle was created before.<br />
<br />
model The model id<br />
<br />
offsetX offsetY offsetZ The offsets<br />
<br />
offsetRX offsetRY offset RZ The offset rotation<br />
<br />
virtualWorld The virtual world of the object.<br />
<br />
interior The interior of the object.<br />
<br />
streamDistance The stream distance (no effect in the Pawn loader if streamer.inc is not included before)<br />
<br />
drawDistance The draw distance<br />
<br />
<font size="4"><font color="Red">M</font>aterials (M index model textureDictionary textureName color)</font><br />
Replaces the material of the last created object or attached object (using the O or A directives) with a specified material. Will throw an error if no object was created before.<br />
<br />
index The material index on the object to which change material (0-15)<br />
<br />
model The model id on which the replacement texture is located<br />
<br />
textureDictionary The name of the TXD file containing the replacement texture<br />
<br />
textureName The name of the replacement texture<br />
<br />
color The material color<br />
<br />
<font size="4"><font color="Red">M</font>aterial Texts (T index text size fontFace fontSize bold fontColor backColor textAlignment)</font><br />
Creates a text on the texture of the last created object or attached object (using the O or A directives). Will throw an error if no object was created before. Remember to escape spaces with a backslash if needed; for example, use Arial\ Black instead of Arial Black!<br />
<br />
index The material index on the object on which you want to add text (0-15)<br />
<br />
text The text to add<br />
<br />
size The size of the material (please check <a href="https://sampwiki.blast.hk/wiki/Material_Size" target="_blank">https://sampwiki.blast.hk/wiki/Material_Size</a>)<br />
<br />
fontFace The font<br />
<br />
fontSize The font size<br />
<br />
bold Whether it's bold or not<br />
<br />
fontColor The color of the text<br />
<br />
backColor The Color of the background<br />
<br />
textAlignment The alignment of text<br />
<br />
<font size="4"><font color="Red">A</font>rray format (C# only)</font><br />
In certain fields, you can use the array format to define multiple values. This feature is only available in the C# loader. Trying to load an SML file with an array specifier using the current version of the Pawn loader will throw an error.<br />
<br />
Example of the array format:<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">[1,2,3,4,5,6,50,51,52]</pre>
</div>It must not contain any space! Use a comma to separate values. The array format supports ranges; the previous example could be rewritten as follow:<br />
<br />
<div style="margin:20px; margin-top:5px">
<div class="smallfont" style="margin-bottom:2px">Code:</div>
<pre class="alt2" dir="ltr" style="
		margin: 0px;
		padding: 6px;
		border: 1px solid #C2C2C2;
		width: 800px;
		height: 34px;
		text-align: left;
		overflow: auto">[1-6,50-52]</pre>
</div><font face="Impact"><font size="6"><font color="Red">L</font>oader (Pawn)</font></font><br />
The Pawn version of the Map Loader consist of a single file, MapLoader.inc, which depends on strlib and sscanf2. In the file you can tweak the limits of each category of item, which affects the total memory used, and the error messages.<br />
<br />
There are 4 functions available:<br />
<br />
MapLoader.Load(const fileNameWithoutExtension[])<br />
Loads a .SML file into memory, without creating or removing anything in the game. The fileNameWithoutExtension parameter must not contain the extension. After this function you could then call Apply() to apply the loaded items, or you could access the loaded data directly to add custom behavior. The function returns the total number of errors encountered.<br />
<br />
MapLoader.Apply()<br />
Applies all the loaded items. Has no effect if the cache is empty (MapLoader.Load wasn't called).<br />
<br />
MapLoader.RemoveForPlayer(playerid)<br />
Call this function under OnPlayerSpawn to apply building removals (I don't like hooks).<br />
<br />
MapLoader.Clear()<br />
Completely clears the cache. You normally should never need to use this function, because it gets automatically called by MapLoader.Load(), unless you comment the #define MAPLDR_AUTO_CLEAR line; if you did, you have the option of manually choosing when to clear the cache.<br />
<br />
<font face="Impact"><font size="6"><font color="Red">L</font>oader (C#)</font></font><br />
The C# version of the Map Loader consist of a .NET Core library project, which depends on SampSharp-GameMode, SampSharp-Core and SampSharp-Streamer.<br />
<br />
There is one constructor and 4 public methods available:<br />
<br />
MapLoader(bool autoClear)<br />
Creates an instance of the MapLoader class. The autoClear parameter specifies whether after every call to Load(), the cache should be cleared. We recommend to pass true in this parameter.<br />
<br />
int Load(string fileName, out List errors)<br />
Loads a file into memory, without creating or removing anything in the game. The fileName must contain the file extension. The functions outputs a list of exceptions, containing all the errors that may have occurred, and returns the total number of lines processed.<br />
<br />
void Apply()<br />
Applies all the loaded items. Has no effect if the cache is empty (Load wasn't called).<br />
<br />
void ApplyRemovals(BasePlayer p)<br />
Equivalent of MapLoader.RemoveForPlayer(playerid) of the Pawn version, it applies all building removals, and should be called in the Spawn event of players, or under the OnSpawned method in your Player class.<br />
<br />
void Clear()<br />
Completely clears the cache. You should never need to use this method, however if you constructed the MapLoader object with the autoClear parameter set to false, then you should clear it manually.<br />
<br />
<font face="Impact"><font size="6"><font color="Red">C</font>onverter</font></font><br />
The Map Converter is a utility that given a file or a list of files, converts them from Pawn to SML and vice-versa. The converter is lossy, in fact it does not support attached objects, materials and material texts. It will only convert objects, vehicles and building removals.<br />
<br />
To use the converter, simply drag and drop a file or multiple files on the Sasinosoft.MapConverter executable file. It will automatically convert files with the .pwn extension to .sml, and files with the .sml extension to .pwn.
<br />
<br />
<hr size="1" />
<!-- end: printthread_post --><!-- start: printthread_post -->
Re: Sasinosoft Map Loader - <a href="memberba57.html?action=profile&amp;uid=294528">TopShooter2</a> -  29.05.2020
<br />
<br />
Brillant job!
<br />
<br />
<hr size="1" />
<!-- end: printthread_post --><!-- start: printthread_post -->
Re: Sasinosoft Map Loader - <a href="memberb946.html?action=profile&amp;uid=13213">Chaprnks</a> -  31.05.2020
<br />
<br />
This is a great attempt at combating the mapping issues, as loading them into the gamemode as an include is very inefficient. Loading it as a filterscript also has issues itself. I wonder if this works in a similar way to SSMM does. Also, is there a linux server plugin also, or is this strictly limited to windows servers only?
<br />
<br />
<hr size="1" />
<!-- end: printthread_post --><!-- start: printthread_post -->
Re: Sasinosoft Map Loader - <a href="memberadf8.html?action=profile&amp;uid=111937">Sasino97</a> -  31.05.2020
<br />
<br />
<div style="margin:20px; margin-top:5px; ">
<div class="smallfont" style="margin-bottom:2px">Quote:</div>
<table border="0" cellpadding="6" cellspacing="0" width="100%">
<tr>
<td class="alt2" style="border: 1px solid #C2C2C2; font-size: 8pt;">
<div>
					Originally Posted by <strong>Chaprnks</strong><br />
<a href="showthread6452.html?pid=4148835#pid4148835" rel="nofollow"><img alt="View Post" border="0" class="inlineimg" src="images/buttons/viewpost.gif"/></a><br />
</div>
<div style="font-style:italic">This is a great attempt at combating the mapping issues, as loading them into the gamemode as an include is very inefficient. Loading it as a filterscript also has issues itself. I wonder if this works in a similar way to SSMM does. Also, is there a linux server plugin also, or is this strictly limited to windows servers only?</div>
</td>
</tr>
</table>
</div>Hi, there is no plugin, you only need to include the .inc file, as the library for Pawn is fully written in Pawn.<br />
There is an optional C# support for users of SampSharp, these DLLs are not sa-mp plugins but libraries to link to in a SampSharp project.<br />
<br />
This project is not as advanced as SSMM, and does only provide the advantage of not needing to recompile your script when maps are changed. My workflow in using it is to create maps with a map editor, exporting them as pawn files, then dragging them on the converter, where they become .sml files, and then adding them to the scriptfiles folder, where I can then load them programmatically using LoadMap() in the script.
<br />
<br />
<hr size="1" />
<!-- end: printthread_post --></div>

</div>
</body>
</html>
<!-- end: printthread -->